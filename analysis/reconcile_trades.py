import re
from collections import defaultdict

POWERSHELL_TRADES_RAW = """
Time                      Strategy   Direction   Entry Close Status PnL     Ticket
----                      --------   ---------   ----- ----- ------ ---     ------
2025-11-12T17:58:25+02:00 ICT_SWING  BUY       4125,61 -     CLOSED -   1927975909
2025-11-12T17:55:07+02:00 ICT_SWING  BUY       4125,57 -     CLOSED -   1927956233
2025-11-12T17:20:04+02:00 ICT_SWING  BUY       4125,47 -     CLOSED -   1927741833
2025-11-12T17:19:33+02:00 ICT_SWING  BUY       4123,86 -     CLOSED -   1927735571
2025-11-12T17:19:02+02:00 ICT_SWING  BUY       4124,29 -     CLOSED -   1927732293
2025-11-12T17:18:31+02:00 ICT_SWING  BUY       4125,14 -     CLOSED -   1927728475
2025-11-12T17:12:26+02:00 ICT_SWING  BUY       4125,49 -     CLOSED -   1927696177
2025-11-12T17:11:20+02:00 ICT_SWING  BUY        4125,1 -     CLOSED -   1927686523
2025-11-12T17:10:49+02:00 ICT_SWING  BUY        4124,5 -     CLOSED -   1927682708
2025-11-12T17:10:18+02:00 ICT_SWING  BUY       4123,32 -     CLOSED -   1927678162
2025-11-12T17:09:48+02:00 ICT_SWING  BUY       4126,69 -     CLOSED -   1927670487
2025-11-12T17:09:17+02:00 ICT_SWING  BUY        4126,9 -     CLOSED -   1927666109
2025-11-12T17:08:46+02:00 ICT_SWING  BUY       4127,12 -     CLOSED -   1927663545
2025-11-12T17:08:15+02:00 ICT_SWING  BUY       4127,23 -     CLOSED -   1927660345
2025-11-12T16:40:14+02:00 ICT_SWING  SELL      4137,74 -     CLOSED -   1927488886
2025-11-12T16:39:43+02:00 ICT_SWING  SELL      4137,87 -     CLOSED -   1927486752
2025-11-12T16:39:11+02:00 ICT_SWING  SELL      4138,41 -     CLOSED -   1927484527
2025-11-12T16:38:40+02:00 ICT_SWING  SELL      4137,94 -     CLOSED -   1927482537
2025-11-12T16:38:10+02:00 ICT_SWING  SELL      4138,55 -     CLOSED -   1927480570
2025-11-12T16:37:39+02:00 ICT_SWING  SELL      4138,42 -     CLOSED -   1927477995
2025-11-12T16:37:08+02:00 ICT_SWING  SELL       4138,3 -     CLOSED -   1927475278
2025-11-12T16:36:37+02:00 ICT_SWING  SELL      4138,21 -     CLOSED -   1927472993
2025-11-12T16:36:06+02:00 ICT_SWING  SELL      4137,43 -     CLOSED -   1927470851
2025-11-12T16:35:33+02:00 ICT_SWING  SELL      4139,12 -     CLOSED -   1927467822
2025-11-12T16:35:02+02:00 ICT_SWING  SELL      4138,68 -     CLOSED -   1927464627
2025-11-12T16:34:31+02:00 ICT_SWING  SELL      4139,28 -     CLOSED -   1927460751
2025-11-12T16:34:00+02:00 ICT_SWING  SELL      4138,21 -     CLOSED -   1927456469
2025-11-12T16:33:29+02:00 ICT_SWING  SELL      4137,66 -     CLOSED -   1927453659
2025-11-12T16:32:59+02:00 ICT_SWING  SELL       4138,2 -     CLOSED -   1927449978
2025-11-12T16:32:27+02:00 ICT_SWING  SELL      4136,89 -     CLOSED -   1927446887
2025-11-12T16:31:54+02:00 ICT_SWING  SELL       4137,3 -     CLOSED -   1927444524
2025-11-12T16:31:25+02:00 ICT_SWING  SELL      4137,21 -     CLOSED -   1927442248
2025-11-12T16:30:54+02:00 ICT_SWING  SELL      4137,68 -     CLOSED -   1927439782
2025-11-12T16:30:23+02:00 ICT_SWING  SELL      4137,27 -     CLOSED -   1927436563
2025-11-12T16:29:53+02:00 ICT_SWING  SELL      4136,26 -     CLOSED -   1927433281
2025-11-12T16:29:22+02:00 ICT_SWING  SELL      4137,51 -     CLOSED -   1927430485
2025-11-12T16:28:52+02:00 ICT_SWING  SELL      4135,83 -     CLOSED -   1927427044
2025-11-12T16:28:21+02:00 ICT_SWING  SELL      4136,47 -     CLOSED -   1927424842
2025-11-12T16:27:51+02:00 ICT_SWING  SELL      4135,82 -     CLOSED -   1927421641
2025-11-12T16:27:19+02:00 ICT_SWING  SELL       4136,4 -     CLOSED -   1927418544
2025-11-12T16:26:45+02:00 ICT_SWING  SELL      4136,53 -     CLOSED -   1927413880
2025-11-12T16:26:12+02:00 ICT_SWING  SELL      4135,23 -     CLOSED -   1927406981
2025-11-12T16:25:40+02:00 ICT_SWING  SELL      4133,36 -     CLOSED -   1927401218
2025-11-12T16:25:09+02:00 ICT_SWING  SELL      4133,39 -     CLOSED -   1927398462
2025-11-12T16:23:11+02:00 ICT_SWING  SELL       4133,5 -     CLOSED -   1927386829
2025-11-12T16:22:39+02:00 ICT_SWING  SELL      4133,91 -     CLOSED -   1927383638
2025-11-12T16:22:05+02:00 ICT_SWING  SELL      4133,32 -     CLOSED -   1927380070
2025-11-12T16:21:33+02:00 ICT_SWING  SELL      4133,37 -     CLOSED -   1927375672
2025-11-12T16:21:01+02:00 ICT_SWING  SELL      4131,53 -     CLOSED -   1927371578
2025-11-12T16:20:29+02:00 ICT_SWING  SELL      4132,31 -     CLOSED -   1927368149
2025-11-12T16:18:48+02:00 ICT_SWING  SELL      4131,92 -     CLOSED -   1927359145
2025-11-12T16:18:17+02:00 ICT_SWING  SELL      4131,63 -     CLOSED -   1927356490
2025-11-12T16:17:45+02:00 ICT_SWING  SELL      4132,23 -     CLOSED -   1927353627
2025-11-12T16:17:07+02:00 ICT_SWING  SELL      4132,15 -     CLOSED -   1927349869
2025-11-12T16:16:22+02:00 ICT_SWING  SELL      4131,81 -     CLOSED -   1927347431
2025-11-12T16:15:44+02:00 ICT_SWING  SELL      4131,64 -     CLOSED -   1927341499
2025-11-12T16:15:08+02:00 ICT_SWING  SELL      4130,58 -     CLOSED -   1927335716
2025-11-12T16:14:31+02:00 ICT_SWING  SELL       4130,1 -     CLOSED -   1927332698
2025-11-12T16:13:58+02:00 ICT_SWING  SELL      4129,64 -     CLOSED -   1927329329
2025-11-12T16:13:25+02:00 ICT_SWING  SELL      4129,37 -     CLOSED -   1927327077
2025-11-12T16:12:34+02:00 ICT_SWING  SELL      4128,68 -     CLOSED -   1927325612
2025-11-12T16:10:21+02:00 ICT_SWING  SELL      4128,58 -     CLOSED -   1927321009
2025-11-12T16:08:02+02:00 ICT_SWING  SELL      4128,04 -     CLOSED -   1927312446
2025-11-12T16:03:41+02:00 ICT_SWING  SELL      4127,79 -     CLOSED -   1927294707
2025-11-12 17:28:10       SWING_HIGH BUY       4168,63 -     OPEN   -   1928698580
2025-11-12 17:27:20       SWING_HIGH BUY       4166,79 -     OPEN   -   1928695119
2025-11-12 17:22:38       SWING_HIGH BUY       4165,97 -     CLOSED -   1928659622
2025-11-12 17:21:07       SWING_HIGH BUY       4164,17 -     CLOSED -   1928643840
2025-11-12 17:20:37       SWING_HIGH BUY       4165,54 -     CLOSED -   1928639678
2025-11-12 17:19:04       SWING_HIGH BUY       4168,36 -     CLOSED -   1928624678
2025-11-12 17:18:33       SWING_HIGH BUY       4170,09 -     CLOSED -   1928619900
2025-11-12 17:18:03       SWING_HIGH BUY       4169,92 -     CLOSED -   1928615693
2025-11-12 17:17:33       SWING_HIGH BUY       4171,51 -     CLOSED -   1928608558
2025-11-12 17:17:02       SWING_HIGH BUY       4167,47 -     CLOSED -   1928601644
2025-11-12 17:16:31       SWING_HIGH BUY       4166,94 -     CLOSED -   1928596375
2025-11-12 17:15:59       SWING_HIGH BUY       4162,05 -     CLOSED -   1928583483
2025-11-12 17:15:29       SWING_HIGH BUY       4161,13 -     CLOSED -   1928578775
2025-11-12 17:14:56       SWING_HIGH BUY          4162 -     CLOSED -   1928571975
2025-11-12 17:14:24       SWING_HIGH BUY       4160,58 -     CLOSED -   1928567173
2025-11-12 17:13:51       SWING_HIGH BUY       4161,28 -     CLOSED -   1928559380
2025-11-12 17:13:20       SWING_HIGH BUY       4158,56 -     CLOSED -   1928552808
2025-11-12 17:12:48       SWING_HIGH BUY        4157,4 -     CLOSED -   1928546586
2025-11-12 17:12:16       SWING_HIGH BUY       4158,35 -     CLOSED -   1928542893
2025-11-12 17:11:46       SWING_HIGH BUY       4157,92 -     CLOSED -   1928535544
2025-11-12 17:11:15       SWING_HIGH BUY       4154,38 -     CLOSED -   1928529594
2025-11-12 17:10:45       SWING_HIGH BUY        4152,4 -     CLOSED -   1928519913
2025-11-12 17:09:43       SWING_HIGH BUY       4144,46 -     CLOSED -   1928495532
2025-11-12 17:09:13       SWING_HIGH BUY       4143,69 -     CLOSED -   1928490118
2025-11-12 17:08:41       SWING_HIGH BUY       4142,89 -     CLOSED -   1928487252
2025-11-12 17:08:11       SWING_HIGH BUY       4141,97 -     CLOSED -   1928484363
2025-11-12 17:06:40       SWING_HIGH BUY       4141,67 -     CLOSED -   1928469325
2025-11-12 17:06:09       SWING_HIGH BUY        4140,4 -     CLOSED -   1928465850
2025-11-12 17:05:39       SWING_HIGH BUY       4141,28 -     CLOSED -   1928462722
2025-11-12 17:04:35       SWING_HIGH BUY       4140,26 -     CLOSED -   1928451702
2025-11-12 17:04:04       SWING_HIGH BUY       4140,03 -     CLOSED -   1928447996
2025-11-12 16:57:09       SWING_HIGH BUY       4139,38 -     CLOSED -   1928402825
2025-11-12 16:56:38       SWING_HIGH BUY       4138,91 -     CLOSED -   1928399022
2025-11-12 16:56:05       SWING_HIGH BUY       4138,63 -     CLOSED -   1928394886
2025-11-12 16:55:34       SWING_HIGH BUY       4139,06 -     CLOSED -   1928392017
2025-11-12 16:54:53       SWING_HIGH BUY       4139,05 -     CLOSED -   1928388087
2025-11-12 16:54:19       SWING_HIGH BUY        4139,1 -     CLOSED -   1928385116
2025-11-12 16:53:48       SWING_HIGH BUY       4138,91 -     CLOSED -   1928381114
2025-11-12 16:52:58       SWING_HIGH BUY       4138,61 -     CLOSED -   1928377207
2025-11-12 16:52:28       SWING_HIGH BUY       4136,99 -     CLOSED -   1928372051
2025-11-12 16:51:56       SWING_HIGH BUY       4138,57 -     CLOSED -   1928368479
2025-11-12 16:51:24       SWING_HIGH BUY       4138,88 -     CLOSED -   1928362405
2025-11-12 16:50:51       SWING_HIGH BUY       4138,12 -     CLOSED -   1928357764
2025-11-12 16:46:50       SWING_HIGH BUY       4135,72 -     CLOSED -   1928319402
2025-11-12 16:46:18       SWING_HIGH BUY       4136,03 -     CLOSED -   1928315586
2025-11-12 16:45:31       SWING_HIGH BUY       4135,16 -     CLOSED -   1928311245
2025-11-12 16:44:50       SWING_HIGH BUY       4136,36 -     CLOSED -   1928305812
2025-11-12 16:43:41       SWING_HIGH BUY       4136,57 -     CLOSED -   1928298422
2025-11-12 16:39:34       SWING_HIGH BUY        4136,3 -     CLOSED -   1928291453
2025-11-12 16:38:14       SWING_HIGH BUY       4136,03 -     CLOSED -   1928255819
2025-11-12 16:25:31       SWING_HIGH BUY       4134,27 -     CLOSED -   1928156561
2025-11-12 16:23:16       SWING_HIGH BUY       4133,79 -     CLOSED -   1928144943
2025-11-12 16:19:59       SWING_HIGH BUY       4132,92 -     CLOSED -   1928124796
2025-11-12 16:18:54       SWING_HIGH BUY       4133,44 -     CLOSED -   1928118882
2025-11-12 16:17:44       SWING_HIGH BUY       4136,19 -     CLOSED -   1928109170
2025-11-12 16:17:13       SWING_HIGH BUY       4135,84 -     CLOSED -   1928105880
2025-11-12 16:16:14       SWING_HIGH BUY       4134,91 -     CLOSED -   1928101459
2025-11-12 16:14:21       SWING_HIGH BUY       4134,11 -     CLOSED -   1928096268
2025-11-12 16:07:33       SWING_HIGH BUY          4135 -     CLOSED -   1928076939
2025-11-12 16:00:35       SWING_HIGH SELL      4127,52 -     CLOSED -   1927990324
2025-11-12 15:59:57       SWING_HIGH SELL      4126,97 -     CLOSED -   1927983641
2025-11-12 15:59:06       SWING_HIGH SELL      4126,39 -     CLOSED -   1927979524
2025-11-12 15:58:25       SWING_HIGH SELL      4125,57 -     CLOSED -   1927975279
2025-11-12 15:57:48       SWING_HIGH SELL      4125,92 -     CLOSED -   1927971854
2025-11-12 15:43:07       SWING_HIGH BUY       4130,66 -     CLOSED -   1927892270
2025-11-12 15:42:24       SWING_HIGH BUY       4130,58 -     CLOSED -   1927888523
2025-11-12 15:39:04       SWING_HIGH BUY       4130,21 -     CLOSED -   1927871330
2025-11-12 15:38:33       SWING_HIGH BUY       4129,69 -     CLOSED -   1927866639
2025-11-12 15:37:55       SWING_HIGH BUY       4129,36 -     CLOSED -   1927862863
2025-11-12 15:37:14       SWING_HIGH BUY       4130,77 -     CLOSED -   1927858544
2025-11-12 15:36:39       SWING_HIGH BUY       4129,33 -     CLOSED -   1927854417
2025-11-12 15:34:50       SWING_HIGH BUY       4131,85 -     CLOSED -   1927843430
2025-11-12 15:33:19       SWING_HIGH BUY       4129,73 -     CLOSED -   1927827503
2025-11-12 15:32:17       SWING_HIGH BUY       4128,62 -     CLOSED -   1927819277
2025-11-12 15:30:09       SWING_HIGH BUY       4127,99 -     CLOSED -   1927806071
2025-11-12 15:29:38       SWING_HIGH BUY       4128,35 -     CLOSED -   1927802386
2025-11-12 15:19:33       SWING_HIGH SELL      4123,82 -     CLOSED -   1927735529
2025-11-12 15:17:00       SWING_HIGH SELL         4126 -     CLOSED -   1927721099
2025-11-12 15:15:29       SWING_HIGH SELL      4125,72 -     CLOSED -   1927712947
2025-11-12 15:14:58       SWING_HIGH SELL         4126 -     CLOSED -   1927709735
2025-11-12 15:14:27       SWING_HIGH SELL      4127,11 -     CLOSED -   1927707537
2025-11-12 15:12:26       SWING_HIGH SELL      4125,44 -     CLOSED -   1927696153
2025-11-12 15:11:20       SWING_HIGH SELL      4125,05 -     CLOSED -   1927686508
2025-11-12 15:10:49       SWING_HIGH SELL      4124,45 -     CLOSED -   1927682677
2025-11-12 15:09:48       SWING_HIGH SELL      4126,66 -     CLOSED -   1927670473
2025-11-12 15:09:17       SWING_HIGH SELL      4126,87 -     CLOSED -   1927666061
2025-11-12 15:08:46       SWING_HIGH SELL      4127,08 -     CLOSED -   1927663517
2025-11-12 15:08:15       SWING_HIGH SELL      4127,19 -     CLOSED -   1927660303
2025-11-12 15:06:08       SWING_HIGH SELL      4128,82 -     CLOSED -   1927644216
2025-11-12 15:04:32       SWING_HIGH SELL      4130,08 -     CLOSED -   1927632601
2025-11-12 15:03:04       SWING_HIGH SELL      4129,72 -     CLOSED -   1927622779
2025-11-12 15:02:03       SWING_HIGH SELL      4128,84 -     CLOSED -   1927616243
2025-11-12 15:00:57       SWING_HIGH SELL      4128,73 -     CLOSED -   1927608427
2025-11-12 15:00:26       SWING_HIGH SELL      4129,52 -     CLOSED -   1927603621
2025-11-12 14:59:54       SWING_HIGH SELL      4130,76 -     CLOSED -   1927598754
2025-11-12 14:59:22       SWING_HIGH SELL      4130,64 -     CLOSED -   1927596521
2025-11-12 14:58:51       SWING_HIGH SELL      4130,85 -     CLOSED -   1927594155
2025-11-12 14:57:51       SWING_HIGH SELL      4130,26 -     CLOSED -   1927587316
2025-11-12 14:57:20       SWING_HIGH SELL      4130,46 -     CLOSED -   1927584397
2025-11-12 14:56:46       SWING_HIGH SELL       4130,8 -     CLOSED -   1927581556
2025-11-12 14:56:15       SWING_HIGH SELL      4131,57 -     CLOSED -   1927578210
2025-11-12 14:55:44       SWING_HIGH SELL      4130,91 -     CLOSED -   1927574091
2025-11-12 14:55:13       SWING_HIGH SELL      4131,27 -     CLOSED -   1927569820
2025-11-12 14:54:43       SWING_HIGH SELL      4132,36 -     CLOSED -   1927565208
2025-11-12 14:53:38       SWING_HIGH SELL      4133,69 -     CLOSED -   1927558756
2025-11-12 14:53:08       SWING_HIGH SELL      4134,08 -     CLOSED -   1927556510
2025-11-12 14:52:07       SWING_HIGH SELL      4134,45 -     CLOSED -   1927551996
2025-11-12 14:51:37       SWING_HIGH SELL      4134,17 -     CLOSED -   1927549663
2025-11-12 14:50:30       SWING_HIGH SELL      4134,37 -     CLOSED -   1927542723
2025-11-12 14:50:02       SWING_HIGH SELL      4134,29 -     CLOSED -   1927541008
2025-11-12 14:48:29       SWING_HIGH SELL       4135,2 -     CLOSED -   1927534371
2025-11-12 14:39:11       SWING_HIGH BUY       4138,44 -     CLOSED -   1927484503
2025-11-12 14:38:40       SWING_HIGH BUY       4137,97 -     CLOSED -   1927482525
2025-11-12 14:38:10       SWING_HIGH BUY       4138,58 -     CLOSED -   1927480563
2025-11-12 14:37:39       SWING_HIGH BUY       4138,45 -     CLOSED -   1927477985
2025-11-12 14:37:08       SWING_HIGH BUY       4138,33 -     CLOSED -   1927475174
2025-11-12 14:36:37       SWING_HIGH BUY       4138,24 -     CLOSED -   1927472952
2025-11-12 14:36:06       SWING_HIGH BUY       4137,47 -     CLOSED -   1927470842
2025-11-12 14:35:33       SWING_HIGH BUY       4139,16 -     CLOSED -   1927467667
2025-11-12 14:35:02       SWING_HIGH BUY       4138,72 -     CLOSED -   1927464594
2025-11-12 14:34:31       SWING_HIGH BUY       4139,32 -     CLOSED -   1927460734
2025-11-12 14:34:00       SWING_HIGH BUY       4138,25 -     CLOSED -   1927456449
2025-11-12 14:30:23       SWING_HIGH BUY       4137,32 -     CLOSED -   1927436515
2025-11-12 14:29:53       SWING_HIGH BUY        4136,3 -     CLOSED -   1927433269
2025-11-12 14:28:21       SWING_HIGH BUY       4136,51 -     CLOSED -   1927424824
2025-11-12 14:26:45       SWING_HIGH BUY       4136,58 -     CLOSED -   1927413555
2025-11-12 14:25:40       SWING_HIGH BUY        4133,4 -     CLOSED -   1927401110
2025-11-12 14:25:09       SWING_HIGH BUY       4133,42 -     CLOSED -   1927398402
2025-11-12 14:24:27       SWING_HIGH BUY       4132,16 -     CLOSED -   1927394690
2025-11-12 14:23:49       SWING_HIGH BUY       4132,52 -     CLOSED -   1927390414
2025-11-12 14:17:07       SWING_HIGH BUY       4132,18 -     CLOSED -   1927349430
2025-11-12 14:16:22       SWING_HIGH BUY       4131,84 -     CLOSED -   1927346874
2025-11-12 14:15:44       SWING_HIGH BUY       4131,73 -     CLOSED -   1927341175
2025-11-12 14:15:08       SWING_HIGH BUY       4130,67 -     CLOSED -   1927335554
2025-11-12 14:14:31       SWING_HIGH BUY       4130,19 -     CLOSED -   1927332519
2025-11-12 14:13:58       SWING_HIGH BUY       4129,73 -     CLOSED -   1927329255
2025-11-12 14:13:25       SWING_HIGH BUY       4129,47 -     CLOSED -   1927327041
2025-11-12 14:12:34       SWING_HIGH BUY       4128,78 -     CLOSED -   1927325484
2025-11-12 14:10:21       SWING_HIGH BUY       4128,68 -     CLOSED -   1927320727
2025-11-12 14:08:02       SWING_HIGH BUY       4128,15 -     CLOSED -   1927309599
2025-11-12 14:03:41       SWING_HIGH BUY       4127,91 -     CLOSED -   1927280362
2025-11-12 14:00:38       SWING_HIGH BUY        4127,1 -     CLOSED -   1927269342
2025-11-12 14:00:04       SWING_HIGH BUY       4125,72 -     CLOSED -   1927260511
2025-11-12 13:55:32       SWING_HIGH BUY       4126,48 -     CLOSED -   1927242312
"""

MT5_POSITIONS_RAW = """
Company:    Exness Technologies Ltd
Date:    2025.11.12 17:30
Positions

Time    Position    Symbol  Type    Volume  Price   S / L   T / P   Time    Price   Commission  Swap    Profit
2025.11.12 11:56:52  1927242312  XAUUSDm buy 0.01    4124.310    4121.474    4130.481    2025.11.12 12:14:22  4130.481    0.00    0.00    6.17
2025.11.12 12:00:08  1927260511  XAUUSDm buy 0.01    4126.276    4120.790    4129.718    2025.11.12 12:05:51  4129.718    0.00    0.00    3.44
2025.11.12 12:01:54  1927269342  XAUUSDm buy 0.01    4125.376    4122.203    4131.098    2025.11.12 12:15:34  4131.098    0.00    0.00    5.72
2025.11.12 12:03:57  1927280362  XAUUSDm buy 0.01    4128.001    4123.274    4131.906    2025.11.12 12:16:19  4131.906    0.00    0.00    3.91
2025.11.12 12:06:16  1927294707  XAUUSDm sell    0.01    4129.618    4131.508    4123.335    2025.11.12 12:15:35  4131.508    0.00    0.00    -1.89
2025.11.12 12:09:08  1927309599  XAUUSDm buy 0.01    4127.319    4123.729    4132.149    2025.11.12 12:16:24  4132.149    0.00    0.00    4.83
2025.11.12 12:09:48  1927312446  XAUUSDm sell    0.01    4127.890    4131.756    4123.583    2025.11.12 12:15:42  4131.756    0.00    0.00    -3.87
2025.11.12 12:12:00  1927320727  XAUUSDm buy 0.01    4128.981    4124.417    4132.683    2025.11.12 12:17:19  4132.683    0.00    0.00    3.70
2025.11.12 12:12:03  1927321009  XAUUSDm sell    0.01    4129.157    4132.295    4124.120    2025.11.12 12:16:24  4132.295    0.00    0.00    -3.14
2025.11.12 12:12:54  1927325484  XAUUSDm buy 0.01    4129.361    4124.744    4132.776    2025.11.12 12:17:20  4132.776    0.00    0.00    3.42
2025.11.12 12:12:55  1927325612  XAUUSDm sell    0.01    4129.396    4132.394    4124.219    2025.11.12 12:16:31  4132.394    0.00    0.00    -2.99
2025.11.12 12:13:27  1927327041  XAUUSDm buy 0.01    4129.633    4129.486    4133.466    2025.11.12 12:21:38  4133.466    0.00    0.00    3.84
2025.11.12 12:13:28  1927327077  XAUUSDm sell    0.01    4129.516    4133.090    4124.914    2025.11.12 12:17:23  4133.090    0.00    0.00    -3.57
2025.11.12 12:14:00  1927329255  XAUUSDm buy 0.01    4129.734    4129.751    4133.731    2025.11.12 12:22:12  4133.731    0.00    0.00    4.00
2025.11.12 12:14:01  1927329329  XAUUSDm sell    0.01    4129.727    4133.361    4125.184    2025.11.12 12:21:19  4133.361    0.00    0.00    -3.63
2025.11.12 12:14:35  1927332519  XAUUSDm buy 0.01    4130.311    4130.209    4134.189    2025.11.12 12:22:58  4134.189    0.00    0.00    3.88
2025.11.12 12:14:38  1927332698  XAUUSDm sell    0.01    4130.112    4133.822    4125.644    2025.11.12 12:21:38  4133.822    0.00    0.00    -3.71
2025.11.12 12:15:12  1927335554  XAUUSDm buy 0.01    4130.926    4127.291    4134.665    2025.11.12 12:25:59  4134.665    0.00    0.00    3.74
2025.11.12 12:15:14  1927335716  XAUUSDm sell    0.01    4130.891    4134.301    4126.122    2025.11.12 12:22:58  4134.301    0.00    0.00    -3.41
2025.11.12 12:15:49  1927341175  XAUUSDm buy 0.01    4131.218    4128.392    4135.725    2025.11.12 12:26:23  4135.725    0.00    0.00    4.51
2025.11.12 12:15:52  1927341499  XAUUSDm sell    0.01    4131.280    4135.362    4127.182    2025.11.12 12:26:00  4135.362    0.00    0.00    -4.08
2025.11.12 12:16:31  1927346874  XAUUSDm buy 0.01    4132.314    4130.615    4135.844    2025.11.12 12:19:26  4130.615    0.00    0.00    -1.69
2025.11.12 12:16:37  1927347431  XAUUSDm sell    0.01    4132.082    4135.533    4127.352    2025.11.12 12:26:23  4135.533    0.00    0.00    -3.45
2025.11.12 12:17:10  1927349430  XAUUSDm buy 0.01    4132.308    4131.004    4136.177    2025.11.12 12:19:14  4131.004    0.00    0.00    -1.31
2025.11.12 12:17:14  1927349869  XAUUSDm sell    0.01    4132.353    4135.867    4127.685    2025.11.12 12:26:23  4135.867    0.00    0.00    -3.52
2025.11.12 12:17:47  1927353627  XAUUSDm sell    0.01    4132.443    4135.947    4127.765    2025.11.12 12:26:23  4135.947    0.00    0.00    -3.51
2025.11.12 12:18:19  1927356490  XAUUSDm sell    0.01    4131.600    4135.946    4126.441    2025.11.12 12:26:23  4135.946    0.00    0.00    -4.35
2025.11.12 12:18:55  1927359145  XAUUSDm sell    0.01    4132.297    4135.947    4127.090    2025.11.12 12:26:23  4135.947    0.00    0.00    -3.65
2025.11.12 12:20:31  1927368149  XAUUSDm sell    0.01    4132.215    4136.034    4127.852    2025.11.12 12:26:23  4136.034    0.00    0.00    -3.81
2025.11.12 12:21:03  1927371578  XAUUSDm sell    0.01    4131.246    4136.033    4126.122    2025.11.12 12:26:23  4136.033    0.00    0.00    -4.78
2025.11.12 12:21:35  1927375672  XAUUSDm sell    0.01    4133.361    4137.094    4128.910    2025.11.12 12:26:47  4137.094    0.00    0.00    -3.73
2025.11.12 12:22:08  1927380070  XAUUSDm sell    0.01    4133.470    4137.094    4128.782    2025.11.12 12:26:47  4137.094    0.00    0.00    -3.62
2025.11.12 12:22:42  1927383638  XAUUSDm sell    0.01    4133.811    4137.629    4129.443    2025.11.12 12:29:18  4137.629    0.00    0.00    -3.82
2025.11.12 12:23:18  1927386829  XAUUSDm sell    0.01    4133.581    4137.628    4128.546    2025.11.12 12:29:18  4137.628    0.00    0.00    -4.05
2025.11.12 12:23:52  1927390414  XAUUSDm buy 0.01    4131.801    4132.542    4136.522    2025.11.12 12:26:24  4136.522    0.00    0.00    4.72
2025.11.12 12:24:35  1927394690  XAUUSDm buy 0.01    4132.560    4132.184    4136.164    2025.11.12 12:26:23  4136.164    0.00    0.00    3.60
2025.11.12 12:25:10  1927398402  XAUUSDm buy 0.01    4133.548    4133.444    4137.424    2025.11.12 12:29:17  4137.424    0.00    0.00    3.87
2025.11.12 12:25:11  1927398462  XAUUSDm sell    0.01    4132.990    4137.628    4128.300    2025.11.12 12:29:18  4137.628    0.00    0.00    -4.64
2025.11.12 12:25:41  1927401110  XAUUSDm buy 0.01    4133.534    4133.420    4137.400    2025.11.12 12:29:17  4137.400    0.00    0.00    3.87
2025.11.12 12:25:42  1927401218  XAUUSDm sell    0.01    4133.470    4137.628    4128.247    2025.11.12 12:29:18  4137.628    0.00    0.00    -4.16
2025.11.12 12:26:15  1927406981  XAUUSDm sell    0.01    4135.032    4138.954    4130.766    2025.11.12 12:34:09  4138.954    0.00    0.00    -3.92
2025.11.12 12:26:47  1927413555  XAUUSDm buy 0.01    4137.361    4136.596    4140.576    2025.11.12 12:40:38  4136.596    0.00    0.00    -0.76
2025.11.12 12:26:48  1927413880  XAUUSDm sell    0.01    4137.235    4140.255    4132.065    2025.11.12 12:37:09  4138.670    0.00    0.00    -1.43
2025.11.12 12:27:21  1927418544  XAUUSDm sell    0.01    4136.420    4140.255    4131.779    2025.11.12 12:37:40  4138.532    0.00    0.00    -2.11
2025.11.12 12:27:51  1927421641  XAUUSDm sell    0.01    4135.825    4140.254    4130.510    2025.11.12 12:38:11  4138.669    0.00    0.00    -2.84
2025.11.12 12:28:22  1927424824  XAUUSDm buy 0.01    4136.583    4136.526    4140.506    2025.11.12 12:40:39  4136.526    0.00    0.00    -0.05
2025.11.12 12:28:22  1927424842  XAUUSDm sell    0.01    4136.492    4140.255    4131.922    2025.11.12 12:38:42  4138.067    0.00    0.00    -1.58
2025.11.12 12:28:52  1927427044  XAUUSDm sell    0.01    4135.832    4140.254    4130.525    2025.11.12 12:39:13  4138.565    0.00    0.00    -2.74
2025.11.12 12:29:23  1927430485  XAUUSDm sell    0.01    4137.509    4141.233    4133.040    2025.11.12 12:39:44  4137.989    0.00    0.00    -0.48
2025.11.12 12:29:53  1927433269  XAUUSDm buy 0.01    4136.420    4136.322    4140.302    2025.11.12 12:40:41  4136.423    0.00    0.00    0.00
2025.11.12 12:29:53  1927433281  XAUUSDm sell    0.01    4136.260    4141.232    4130.294    2025.11.12 12:40:14  4137.899    0.00    0.00    -1.64
2025.11.12 12:30:24  1927436515  XAUUSDm buy 0.01    4137.395    4137.336    4141.316    2025.11.12 12:35:57  4137.336    0.00    0.00    -0.06
2025.11.12 12:30:24  1927436563  XAUUSDm sell    0.01    4136.979    4141.233    4132.522    2025.11.12 12:40:41  4136.583    0.00    0.00    0.40
2025.11.12 12:30:55  1927439782  XAUUSDm sell    0.01    4137.682    4141.406    4133.213    2025.11.12 12:40:41  4136.583    0.00    0.00    1.10
2025.11.12 12:31:25  1927442248  XAUUSDm sell    0.01    4137.210    4141.405    4132.175    2025.11.12 12:40:41  4136.633    0.00    0.00    0.58
2025.11.12 12:31:56  1927444524  XAUUSDm sell    0.01    4137.466    4141.406    4132.365    2025.11.12 12:40:41  4136.633    0.00    0.00    0.84
2025.11.12 12:32:29  1927446887  XAUUSDm sell    0.01    4137.006    4141.405    4131.478    2025.11.12 12:40:41  4136.633    0.00    0.00    0.38
2025.11.12 12:33:00  1927449978  XAUUSDm sell    0.01    4138.024    4141.925    4133.732    2025.11.12 12:40:41  4136.633    0.00    0.00    1.39
2025.11.12 12:33:31  1927453659  XAUUSDm sell    0.01    4138.086    4141.925    4132.553    2025.11.12 12:40:43  4136.540    0.00    0.00    1.55
2025.11.12 12:34:01  1927456449  XAUUSDm buy 0.01    4138.365    4136.828    4142.246    2025.11.12 12:40:38  4136.828    0.00    0.00    -1.54
2025.11.12 12:34:01  1927456469  XAUUSDm sell    0.01    4138.205    4141.935    4133.742    2025.11.12 12:40:43  4136.540    0.00    0.00    1.67
2025.11.12 12:34:32  1927460734  XAUUSDm buy 0.01    4139.441    4137.763    4143.319    2025.11.12 12:35:50  4137.763    0.00    0.00    -1.68
2025.11.12 12:34:32  1927460751  XAUUSDm sell    0.01    4139.407    4143.006    4134.811    2025.11.12 12:40:44  4136.477    0.00    0.00    2.93
2025.11.12 12:35:03  1927464594  XAUUSDm buy 0.01    4138.844    4137.164    4142.722    2025.11.12 12:40:38  4137.164    0.00    0.00    -1.68
2025.11.12 12:35:03  1927464627  XAUUSDm sell    0.01    4138.684    4143.006    4133.498    2025.11.12 12:40:45  4136.303    0.00    0.00    2.38
2025.11.12 12:35:34  1927467667  XAUUSDm buy 0.01    4139.255    4137.627    4143.155    2025.11.12 12:35:51  4137.627    0.00    0.00    -1.63
2025.11.12 12:35:36  1927467822  XAUUSDm sell    0.01    4139.154    4143.006    4134.452    2025.11.12 12:40:45  4136.421    0.00    0.00    2.73
2025.11.12 12:36:06  1927470842  XAUUSDm buy 0.01    4137.624    4135.792    4141.474    2025.11.12 12:40:45  4136.261    0.00    0.00    -1.36
2025.11.12 12:36:07  1927470851  XAUUSDm sell    0.01    4137.464    4143.005    4130.747    2025.11.12 12:40:45  4136.404    0.00    0.00    1.06
2025.11.12 12:36:37  1927472952  XAUUSDm buy 0.01    4138.367    4136.695    4142.245    2025.11.12 12:40:39  4136.695    0.00    0.00    -1.67
2025.11.12 12:36:38  1927472993  XAUUSDm sell    0.01    4138.362    4143.005    4132.449    2025.11.12 12:40:46  4136.404    0.00    0.00    1.96
2025.11.12 12:37:09  1927475174  XAUUSDm buy 0.01    4138.513    4136.953    4142.334    2025.11.12 12:40:38  4136.953    0.00    0.00    -1.56
2025.11.12 12:37:09  1927475278  XAUUSDm sell    0.01    4138.353    4143.005    4132.653    2025.11.12 12:40:47  4136.451    0.00    0.00    1.90
2025.11.12 12:37:39  1927477985  XAUUSDm buy 0.01    4138.440    4137.203    4142.452    2025.11.12 12:40:38  4137.203    0.00    0.00    -1.24
2025.11.12 12:37:40  1927477995  XAUUSDm sell    0.01    4138.316    4143.006    4132.922    2025.11.12 12:40:47  4136.451    0.00    0.00    1.87
2025.11.12 12:38:10  1927480563  XAUUSDm buy 0.01    4138.710    4137.371    4142.579    2025.11.12 12:39:47  4137.371    0.00    0.00    -1.34
2025.11.12 12:38:11  1927480570  XAUUSDm sell    0.01    4138.509    4143.006    4133.203    2025.11.12 12:40:47  4136.601    0.00    0.00    1.91
2025.11.12 12:38:41  1927482525  XAUUSDm buy 0.01    4138.098    4136.739    4141.968    2025.11.12 12:40:39  4136.739    0.00    0.00    -1.36
2025.11.12 12:38:41  1927482537  XAUUSDm sell    0.01    4137.938    4143.005    4131.857    2025.11.12 12:40:47  4136.601    0.00    0.00    1.34
2025.11.12 12:39:13  1927484503  XAUUSDm buy 0.01    4138.565    4137.158    4142.444    2025.11.12 12:40:38  4137.158    0.00    0.00    -1.41
2025.11.12 12:39:13  1927484527  XAUUSDm sell    0.01    4138.405    4143.006    4132.902    2025.11.12 12:40:47  4136.636    0.00    0.00    1.77
2025.11.12 12:39:44  1927486752  XAUUSDm sell    0.01    4137.829    4143.005    4131.708    2025.11.12 12:40:48  4136.636    0.00    0.00    1.19
2025.11.12 12:40:14  1927488886  XAUUSDm sell    0.01    4137.739    4143.005    4131.420    2025.11.12 12:40:48  4136.669    0.00    0.00    1.07
2025.11.12 12:48:30  1927534371  XAUUSDm sell    0.01    4135.241    4135.185    4131.205    2025.11.12 12:53:05  4135.185    0.00    0.00    0.05
2025.11.12 12:50:03  1927541008  XAUUSDm sell    0.01    4134.316    4134.268    4130.288    2025.11.12 12:57:42  4130.288    0.00    0.00    4.03
2025.11.12 12:50:37  1927542723  XAUUSDm sell    0.01    4134.304    4134.354    4130.374    2025.11.12 12:57:42  4130.374    0.00    0.00    3.93
2025.11.12 12:51:38  1927549663  XAUUSDm sell    0.01    4134.047    4134.149    4130.169    2025.11.12 12:57:59  4130.169    0.00    0.00    3.88
2025.11.12 12:52:08  1927551996  XAUUSDm sell    0.01    4134.473    4134.425    4130.445    2025.11.12 12:55:35  4130.445    0.00    0.00    4.02
2025.11.12 12:53:09  1927556510  XAUUSDm sell    0.01    4134.156    4134.062    4129.687    2025.11.12 13:00:05  4129.687    0.00    0.00    4.03
2025.11.12 12:53:39  1927558756  XAUUSDm sell    0.01    4133.715    4133.667    4129.687    2025.11.12 13:00:05  4129.687    0.00    0.00    4.03
2025.11.12 12:54:43  1927565208  XAUUSDm sell    0.01    4132.388    4132.337    4128.357    2025.11.12 12:56:12  4132.376    0.00    0.00    0.01
2025.11.12 12:55:14  1927569820  XAUUSDm sell    0.01    4131.242    4131.247    4127.267    2025.11.12 13:05:06  4131.247    0.00    0.00    -0.01
2025.11.12 12:55:45  1927574091  XAUUSDm sell    0.01    4130.853    4132.035    4126.909    2025.11.12 12:56:08  4132.035    0.00    0.00    -1.19
2025.11.12 12:56:16  1927578210  XAUUSDm sell    0.01    4131.601    4131.552    4127.572    2025.11.12 13:01:12  4127.572    0.00    0.00    4.03
2025.11.12 12:56:48  1927581556  XAUUSDm sell    0.01    4130.914    4130.777    4126.797    2025.11.12 13:03:27  4130.777    0.00    0.00    0.13
2025.11.12 12:57:21  1927584397  XAUUSDm sell    0.01    4130.486    4130.435    4126.455    2025.11.12 13:02:44  4130.435    0.00    0.00    0.05
2025.11.12 12:57:51  1927587316  XAUUSDm sell    0.01    4130.205    4130.244    4126.264    2025.11.12 13:02:42  4130.244    0.00    0.00    -0.03
2025.11.12 12:58:52  1927594155  XAUUSDm sell    0.01    4130.810    4130.829    4126.849    2025.11.12 13:03:58  4130.829    0.00    0.00    -0.02
2025.11.12 12:59:23  1927596521  XAUUSDm sell    0.01    4130.633    4130.620    4126.640    2025.11.12 13:03:23  4130.620    0.00    0.00    0.01
2025.11.12 12:59:56  1927598754  XAUUSDm sell    0.01    4130.426    4130.736    4126.756    2025.11.12 13:03:23  4130.736    0.00    0.00    -0.31
2025.11.12 13:00:26  1927603621  XAUUSDm sell    0.01    4129.550    4130.590    4125.524    2025.11.12 13:03:23  4130.590    0.00    0.00    -1.04
2025.11.12 13:00:58  1927608427  XAUUSDm sell    0.01    4128.582    4129.850    4124.726    2025.11.12 13:02:13  4129.850    0.00    0.00    -1.27
2025.11.12 13:02:03  1927616243  XAUUSDm sell    0.01    4128.704    4130.088    4124.844    2025.11.12 13:02:39  4130.088    0.00    0.00    -1.39
2025.11.12 13:03:04  1927622779  XAUUSDm sell    0.01    4129.651    4130.878    4125.718    2025.11.12 13:04:15  4130.878    0.00    0.00    -1.23
2025.11.12 13:04:37  1927632601  XAUUSDm sell    0.01    4130.624    4131.207    4126.077    2025.11.12 13:04:58  4131.207    0.00    0.00    -0.59
2025.11.12 13:06:09  1927644216  XAUUSDm sell    0.01    4128.500    4130.375    4124.818    2025.11.12 13:07:29  4130.375    0.00    0.00    -1.88
2025.11.12 13:08:16  1927660303  XAUUSDm sell    0.01    4127.373    4128.883    4123.194    2025.11.12 13:10:14  4123.194    0.00    0.00    4.18
2025.11.12 13:08:16  1927660345  XAUUSDm buy 0.01    4127.522    4121.883    4133.657    2025.11.12 13:18:32  4125.174    0.00    0.00    -2.35
2025.11.12 13:08:47  1927663517  XAUUSDm sell    0.01    4127.118    4128.638    4123.080    2025.11.12 13:10:15  4123.080    0.00    0.00    4.04
2025.11.12 13:08:47  1927663545  XAUUSDm buy 0.01    4127.209    4121.884    4133.399    2025.11.12 13:19:03  4124.286    0.00    0.00    -2.92
2025.11.12 13:09:17  1927666061  XAUUSDm sell    0.01    4126.972    4126.849    4122.869    2025.11.12 13:11:25  4126.849    0.00    0.00    0.12
2025.11.12 13:09:18  1927666109  XAUUSDm buy 0.01    4127.330    4121.884    4132.928    2025.11.12 13:20:13  4125.699    0.00    0.00    -1.63
2025.11.12 13:09:48  1927670473  XAUUSDm sell    0.01    4126.691    4126.636    4122.656    2025.11.12 13:11:24  4126.636    0.00    0.00    0.05
2025.11.12 13:09:48  1927670487  XAUUSDm buy 0.01    4126.727    4121.884    4132.459    2025.11.12 13:20:14  4125.801    0.00    0.00    -0.93
2025.11.12 13:10:18  1927678162  XAUUSDm buy 0.01    4123.597    4123.342    4127.775    2025.11.12 13:19:43  4123.342    0.00    0.00    -0.26
2025.11.12 13:10:50  1927682677  XAUUSDm sell    0.01    4124.495    4126.416    4120.447    2025.11.12 13:11:23  4126.416    0.00    0.00    -1.92
2025.11.12 13:10:50  1927682708  XAUUSDm buy 0.01    4124.946    4119.610    4130.357    2025.11.12 13:21:16  4126.171    0.00    0.00    1.22
2025.11.12 13:11:20  1927686508  XAUUSDm sell    0.01    4125.264    4126.988    4121.050    2025.11.12 13:11:25  4126.988    0.00    0.00    -1.73
2025.11.12 13:11:20  1927686523  XAUUSDm buy 0.01    4125.424    4119.609    4131.682    2025.11.12 13:21:47  4126.173    0.00    0.00    0.75
2025.11.12 13:12:27  1927696153  XAUUSDm sell    0.01    4125.679    4127.257    4121.442    2025.11.12 13:13:07  4127.257    0.00    0.00    -1.58
2025.11.12 13:12:27  1927696177  XAUUSDm buy 0.01    4125.946    4119.609    4132.538    2025.11.12 13:22:48  4128.355    0.00    0.00    2.41
2025.11.12 13:14:28  1927707537  XAUUSDm sell    0.01    4127.195    4127.087    4123.107    2025.11.12 13:20:21  4127.087    0.00    0.00    0.11
2025.11.12 13:14:59  1927709735  XAUUSDm sell    0.01    4125.926    4125.985    4122.005    2025.11.12 13:20:06  4125.985    0.00    0.00    -0.06
2025.11.12 13:15:30  1927712947  XAUUSDm sell    0.01    4125.883    4127.464    4121.725    2025.11.12 13:22:07  4127.464    0.00    0.00    -1.58
2025.11.12 13:17:01  1927721099  XAUUSDm sell    0.01    4125.781    4128.039    4122.004    2025.11.12 13:22:13  4128.039    0.00    0.00    -2.26
2025.11.12 13:18:32  1927728475  XAUUSDm buy 0.01    4125.334    4119.609    4131.783    2025.11.12 13:29:08  4129.045    0.00    0.00    3.72
2025.11.12 13:19:03  1927732293  XAUUSDm buy 0.01    4124.446    4119.610    4129.897    2025.11.12 13:24:36  4129.897    0.00    0.00    5.45
2025.11.12 13:19:34  1927735529  XAUUSDm sell    0.01    4123.954    4125.449    4119.821    2025.11.12 13:20:03  4125.449    0.00    0.00    -1.50
2025.11.12 13:19:34  1927735571  XAUUSDm buy 0.01    4124.114    4123.881    4128.962    2025.11.12 13:23:38  4128.962    0.00    0.00    4.85
2025.11.12 13:20:12  1927741833  XAUUSDm buy 0.01    4125.892    4119.609    4132.494    2025.11.12 13:30:41  4127.589    0.00    0.00    1.70
2025.11.12 13:29:38  1927802386  XAUUSDm buy 0.01    4128.342    4126.860    4132.352    2025.11.12 13:30:53  4126.860    0.00    0.00    -1.48
2025.11.12 13:30:10  1927806071  XAUUSDm buy 0.01    4128.358    4126.694    4131.988    2025.11.12 13:30:53  4126.694    0.00    0.00    -1.67
2025.11.12 13:32:18  1927819277  XAUUSDm buy 0.01    4128.757    4128.644    4132.624    2025.11.12 13:35:01  4132.624    0.00    0.00    3.86
2025.11.12 13:33:21  1927827503  XAUUSDm buy 0.01    4129.950    4129.746    4133.726    2025.11.12 13:35:59  4129.746    0.00    0.00    -0.20
2025.11.12 13:35:20  1927843430  XAUUSDm buy 0.01    4131.228    4130.722    4135.853    2025.11.12 13:35:30  4130.722    0.00    0.00    -0.51
2025.11.12 13:36:42  1927854417  XAUUSDm buy 0.01    4129.725    4128.048    4133.327    2025.11.12 13:40:33  4128.048    0.00    0.00    -1.68
2025.11.12 13:37:21  1927858544  XAUUSDm buy 0.01    4130.819    4129.314    4134.770    2025.11.12 13:37:38  4129.314    0.00    0.00    -1.51
2025.11.12 13:38:00  1927862863  XAUUSDm buy 0.01    4129.147    4129.381    4133.361    2025.11.12 13:44:04  4129.381    0.00    0.00    0.23
2025.11.12 13:38:35  1927866639  XAUUSDm buy 0.01    4130.439    4128.125    4133.687    2025.11.12 13:40:34  4128.125    0.00    0.00    -2.31
2025.11.12 13:39:14  1927871330  XAUUSDm buy 0.01    4129.136    4128.625    4134.211    2025.11.12 13:39:37  4128.625    0.00    0.00    -0.51
2025.11.12 13:42:30  1927888523  XAUUSDm buy 0.01    4130.868    4128.822    4134.578    2025.11.12 13:44:08  4128.822    0.00    0.00    -2.05
2025.11.12 13:43:13  1927892270  XAUUSDm buy 0.01    4131.463    4128.928    4134.657    2025.11.12 13:44:08  4128.928    0.00    0.00    -2.53
2025.11.12 13:55:14  1927956233  XAUUSDm buy 0.01    4125.498    4125.589    4132.721    2025.11.12 14:04:15  4132.721    0.00    0.00    7.22
2025.11.12 13:57:53  1927971854  XAUUSDm sell    0.01    4125.505    4127.616    4121.917    2025.11.12 14:00:10  4127.616    0.00    0.00    -2.11
2025.11.12 13:58:29  1927975279  XAUUSDm sell    0.01    4125.557    4127.111    4121.568    2025.11.12 13:59:15  4127.111    0.00    0.00    -1.55
2025.11.12 13:58:36  1927975909  XAUUSDm buy 0.01    4126.189    4125.626    4132.802    2025.11.12 14:04:15  4132.802    0.00    0.00    6.61
2025.11.12 13:59:15  1927979524  XAUUSDm sell    0.01    4126.877    4127.987    4122.387    2025.11.12 14:00:12  4127.987    0.00    0.00    -1.11
2025.11.12 13:59:58  1927983641  XAUUSDm sell    0.01    4127.065    4128.407    4122.973    2025.11.12 14:01:46  4128.407    0.00    0.00    -1.34
2025.11.12 14:00:54  1927990324  XAUUSDm sell    0.01    4127.924    4128.967    4123.524    2025.11.12 14:01:48  4128.967    0.00    0.00    -1.05
2025.11.12 14:12:35  1928076939  XAUUSDm buy 0.01    4136.839    4133.087    4139.000    2025.11.12 14:19:03  4133.087    0.00    0.00    -3.75
2025.11.12 14:15:33  1928096268  XAUUSDm buy 0.01    4135.311    4134.129    4138.109    2025.11.12 14:18:31  4134.129    0.00    0.00    -1.18
2025.11.12 14:16:28  1928101459  XAUUSDm buy 0.01    4134.985    4132.918    4138.913    2025.11.12 14:19:04  4132.918    0.00    0.00    -2.07
2025.11.12 14:17:14  1928105880  XAUUSDm buy 0.01    4136.063    4133.721    4139.843    2025.11.12 14:18:50  4133.721    0.00    0.00    -2.34
2025.11.12 14:17:47  1928109170  XAUUSDm buy 0.01    4136.215    4134.262    4140.187    2025.11.12 14:18:30  4134.262    0.00    0.00    -1.96
2025.11.12 14:19:10  1928118882  XAUUSDm buy 0.01    4133.299    4131.182    4137.442    2025.11.12 14:30:06  4131.182    0.00    0.00    -2.12
2025.11.12 14:20:00  1928124796  XAUUSDm buy 0.01    4133.105    4130.844    4136.923    2025.11.12 14:30:07  4130.844    0.00    0.00    -2.27
2025.11.12 14:23:21  1928144943  XAUUSDm buy 0.01    4133.992    4131.883    4137.787    2025.11.12 14:24:02  4131.883    0.00    0.00    -2.11
2025.11.12 14:25:36  1928156561  XAUUSDm buy 0.01    4133.769    4132.692    4138.274    2025.11.12 14:25:42  4132.692    0.00    0.00    -1.08
2025.11.12 14:38:18  1928255819  XAUUSDm buy 0.01    4136.070    4132.036    4140.029    2025.11.12 14:47:25  4132.036    0.00    0.00    -4.03
2025.11.12 14:42:58  1928291453  XAUUSDm buy 0.01    4137.444    4132.406    4140.298    2025.11.12 14:47:25  4132.406    0.00    0.00    -5.03
2025.11.12 14:44:04  1928298422  XAUUSDm buy 0.01    4134.905    4132.646    4140.573    2025.11.12 14:47:23  4132.646    0.00    0.00    -2.26
2025.11.12 14:44:55  1928305812  XAUUSDm buy 0.01    4136.219    4132.425    4140.364    2025.11.12 14:47:25  4132.425    0.00    0.00    -3.79
2025.11.12 14:45:33  1928311245  XAUUSDm buy 0.01    4135.519    4131.144    4139.161    2025.11.12 14:51:29  4139.161    0.00    0.00    3.64
2025.11.12 14:46:20  1928315586  XAUUSDm buy 0.01    4135.943    4132.113    4140.025    2025.11.12 14:47:26  4132.113    0.00    0.00    -3.83
2025.11.12 14:46:53  1928319402  XAUUSDm buy 0.01    4135.508    4131.839    4139.722    2025.11.12 14:51:29  4139.722    0.00    0.00    4.21
2025.11.12 14:50:53  1928357764  XAUUSDm buy 0.01    4138.119    4135.723    4142.117    2025.11.12 14:58:08  4135.723    0.00    0.00    -2.40
2025.11.12 14:51:25  1928362405  XAUUSDm buy 0.01    4139.094    4136.585    4142.882    2025.11.12 14:57:47  4136.585    0.00    0.00    -2.50
2025.11.12 14:51:57  1928368479  XAUUSDm buy 0.01    4138.418    4136.397    4142.568    2025.11.12 14:57:48  4136.397    0.00    0.00    -2.02
2025.11.12 14:52:29  1928372051  XAUUSDm buy 0.01    4137.079    4134.622    4140.986    2025.11.12 15:01:50  4134.622    0.00    0.00    -2.46
2025.11.12 14:53:09  1928377207  XAUUSDm buy 0.01    4138.228    4136.042    4142.613    2025.11.12 14:58:07  4136.042    0.00    0.00    -2.19
2025.11.12 14:53:49  1928381114  XAUUSDm buy 0.01    4138.908    4136.472    4142.909    2025.11.12 14:57:48  4136.472    0.00    0.00    -2.44
2025.11.12 14:54:24  1928385116  XAUUSDm buy 0.01    4139.317    4136.761    4143.100    2025.11.12 14:57:47  4136.761    0.00    0.00    -2.56
2025.11.12 14:54:58  1928388087  XAUUSDm buy 0.01    4139.385    4136.753    4143.054    2025.11.12 14:57:47  4136.753    0.00    0.00    -2.64
2025.11.12 14:55:35  1928392017  XAUUSDm buy 0.01    4139.089    4137.273    4143.056    2025.11.12 14:57:45  4137.273    0.00    0.00    -1.82
2025.11.12 14:56:07  1928394886  XAUUSDm buy 0.01    4139.224    4136.885    4142.627    2025.11.12 14:57:46  4136.885    0.00    0.00    -2.33
2025.11.12 14:56:38  1928399022  XAUUSDm buy 0.01    4139.196    4137.356    4142.911    2025.11.12 14:57:45  4137.356    0.00    0.00    -1.84
2025.11.12 14:57:09  1928402825  XAUUSDm buy 0.01    4139.457    4137.859    4143.384    2025.11.12 14:57:44  4137.859    0.00    0.00    -1.60
2025.11.12 15:04:05  1928447996  XAUUSDm buy 0.01    4140.142    4140.052    4144.032    2025.11.12 15:05:21  4140.052    0.00    0.00    -0.09
2025.11.12 15:04:35  1928451702  XAUUSDm buy 0.01    4140.300    4140.278    4144.258    2025.11.12 15:05:20  4140.278    0.00    0.00    -0.02
2025.11.12 15:05:39  1928462722  XAUUSDm buy 0.01    4141.387    4141.303    4145.283    2025.11.12 15:10:05  4145.283    0.00    0.00    3.89
2025.11.12 15:06:10  1928465850  XAUUSDm buy 0.01    4140.511    4140.421    4144.401    2025.11.12 15:07:14  4144.401    0.00    0.00    3.89
2025.11.12 15:06:40  1928469325  XAUUSDm buy 0.01    4141.784    4141.694    4145.674    2025.11.12 15:08:11  4141.658    0.00    0.00    -0.12
2025.11.12 15:08:11  1928484363  XAUUSDm buy 0.01    4142.074    4141.994    4145.974    2025.11.12 15:10:10  4145.974    0.00    0.00    3.90
2025.11.12 15:08:42  1928487252  XAUUSDm buy 0.01    4143.075    4140.620    4146.894    2025.11.12 15:10:10  4146.894    0.00    0.00    3.81
2025.11.12 15:09:13  1928490118  XAUUSDm buy 0.01    4143.793    4141.370    4147.690    2025.11.12 15:10:12  4147.690    0.00    0.00    3.90
2025.11.12 15:09:44  1928495532  XAUUSDm buy 0.01    4144.601    4144.484    4148.464    2025.11.12 15:10:15  4148.464    0.00    0.00    3.86
2025.11.12 15:10:45  1928519913  XAUUSDm buy 0.01    4152.363    4149.202    4156.398    2025.11.12 15:11:43  4156.398    0.00    0.00    4.04
2025.11.12 15:11:15  1928529594  XAUUSDm buy 0.01    4155.012    4154.401    4158.381    2025.11.12 15:11:47  4158.381    0.00    0.00    3.37
2025.11.12 15:11:46  1928535544  XAUUSDm buy 0.01    4157.965    4154.216    4161.919    2025.11.12 15:13:56  4161.919    0.00    0.00    3.95
2025.11.12 15:12:17  1928542893  XAUUSDm buy 0.01    4157.837    4158.365    4162.345    2025.11.12 15:15:01  4162.345    0.00    0.00    4.51
2025.11.12 15:12:48  1928546586  XAUUSDm buy 0.01    4157.287    4157.425    4161.405    2025.11.12 15:13:55  4161.405    0.00    0.00    4.12
2025.11.12 15:13:20  1928552808  XAUUSDm buy 0.01    4158.767    4155.084    4162.565    2025.11.12 15:15:10  4162.565    0.00    0.00    3.80
2025.11.12 15:13:52  1928559380  XAUUSDm buy 0.01    4161.235    4157.592    4165.283    2025.11.12 15:16:07  4165.283    0.00    0.00    4.04
2025.11.12 15:14:25  1928567173  XAUUSDm buy 0.01    4160.459    4157.108    4164.583    2025.11.12 15:16:07  4164.583    0.00    0.00    4.12
2025.11.12 15:14:57  1928571975  XAUUSDm buy 0.01    4162.178    4158.465    4165.997    2025.11.12 15:16:08  4165.997    0.00    0.00    3.82
2025.11.12 15:15:29  1928578775  XAUUSDm buy 0.01    4161.502    4157.596    4165.129    2025.11.12 15:16:07  4165.129    0.00    0.00    3.63
2025.11.12 15:16:01  1928583483  XAUUSDm buy 0.01    4162.263    4158.520    4166.054    2025.11.12 15:16:08  4166.054    0.00    0.00    3.79
2025.11.12 15:16:32  1928596375  XAUUSDm buy 0.01    4166.871    4162.808    4170.939    2025.11.12 15:17:22  4170.939    0.00    0.00    4.07
2025.11.12 15:17:03  1928601644  XAUUSDm buy 0.01    4167.698    4163.379    4171.475    2025.11.12 15:17:34  4171.475    0.00    0.00    3.78
2025.11.12 15:17:33  1928608558  XAUUSDm buy 0.01    4171.568    4167.340    4175.510    2025.11.12 15:19:10  4167.340    0.00    0.00    -4.23
2025.11.12 15:18:04  1928615693  XAUUSDm buy 0.01    4170.026    4166.165    4173.924    2025.11.12 15:19:25  4166.165    0.00    0.00    -3.86
2025.11.12 15:18:34  1928619900  XAUUSDm buy 0.01    4170.014    4166.600    4174.094    2025.11.12 15:19:22  4166.600    0.00    0.00    -3.41
2025.11.12 15:19:06  1928624678  XAUUSDm buy 0.01    4168.435    4165.133    4172.364    2025.11.12 15:20:07  4165.133    0.00    0.00    -3.31
2025.11.12 15:20:37  1928639678  XAUUSDm buy 0.01    4165.795    4162.267    4169.541    2025.11.12 15:21:29  4162.267    0.00    0.00    -3.53
2025.11.12 15:21:08  1928643840  XAUUSDm buy 0.01    4164.005    4161.098    4168.174    2025.11.12 15:21:38  4161.098    0.00    0.00    -2.91
2025.11.12 15:22:38  1928659622  XAUUSDm buy 0.01    4166.071    4162.240    4169.967    2025.11.12 15:23:24  4162.240    0.00    0.00    -3.83
2025.11.12 15:27:37  1928695119  XAUUSDm buy 0.01    4168.331    4164.109    4170.787    2025.11.12 15:31:38  4170.787    0.00    0.00    2.46
2025.11.12 15:29:41  1928709146  XAUUSDm buy 0.01    4166.815    4164.463    4170.895    2025.11.12 15:31:39  4170.895    0.00    0.00    4.08
2025.11.12 15:30:12  1928712317  XAUUSDm buy 0.01    4166.772    4166.479    4170.459    2025.11.12 15:31:26  4170.459    0.00    0.00    3.69
"""


def parse_powershell_trades(raw: str):
    trades = {}
    for line in raw.strip().splitlines():
        line = line.rstrip()
        if not line or line.startswith("Time") or line.startswith("----"):
            continue
        tokens = line.split()
        if len(tokens) < 7:
            continue
        time_token = tokens[0]
        idx = 1
        if idx < len(tokens) and re.match(r"\d{2}:\d{2}:\d{2}", tokens[idx]):
            time_token = f"{time_token} {tokens[idx]}"
            idx += 1
        strategy = tokens[idx]
        idx += 1
        direction = tokens[idx]
        idx += 1
        entry = tokens[idx]
        idx += 1
        close_price = tokens[idx]
        idx += 1
        status = tokens[idx]
        idx += 1
        pnl = tokens[idx]
        idx += 1
        ticket = tokens[idx]
        trade = {
            "timestamp": time_token,
            "strategy": strategy,
            "direction": direction,
            "entry": float(entry.replace(",", ".")),
            "close": None if close_price == "-" else float(close_price.replace(",", ".")),
            "status": status,
            "pnl_reported": None if pnl == "-" else float(pnl.replace(",", ".").replace("$", "")),
        }
        trades[ticket] = trade
    return trades


def parse_mt5_positions(raw: str):
    positions = {}
    for line in raw.strip().splitlines():
        line = re.sub(r"\s+", " ", line.strip())
        if not line or not re.match(r"\d{4}\.\d{2}\.\d{2}", line):
            continue
        tokens = line.split(" ")
        if len(tokens) < 14:
            continue
        open_time = f"{tokens[0]} {tokens[1]}"
        ticket = tokens[2]
        symbol = tokens[3]
        order_type = tokens[4]
        volume = float(tokens[5])
        price = float(tokens[6])
        sl = float(tokens[7])
        tp = float(tokens[8])
        close_time = f"{tokens[9]} {tokens[10]}"
        close_price = float(tokens[11])
        commission = float(tokens[12])
        swap = float(tokens[13])
        profit = float(tokens[14])

        positions[ticket] = {
            "open_time": open_time,
            "symbol": symbol,
            "type": order_type,
            "volume": volume,
            "price": price,
            "sl": sl,
            "tp": tp,
            "close_time": close_time,
            "close_price": close_price,
            "commission": commission,
            "swap": swap,
            "profit": profit,
        }
    return positions


def reconcile(trades, positions):
    matched = {}
    only_trades = {}
    only_positions = {}

    for ticket, trade in trades.items():
        if ticket in positions:
            matched[ticket] = {**trade, **positions[ticket]}
        else:
            only_trades[ticket] = trade

    for ticket, position in positions.items():
        if ticket not in trades:
            only_positions[ticket] = position

    return matched, only_trades, only_positions


def summarise_matches(matched):
    strategy_stats = defaultdict(lambda: {"count": 0, "profit": 0.0})
    mismatches = []
    for ticket, data in matched.items():
        strategy = data.get("strategy", "UNKNOWN")
        strategy_stats[strategy]["count"] += 1
        strategy_stats[strategy]["profit"] += data["profit"]

        direction = data.get("direction")
        mt5_type = data.get("type", "").upper()
        if direction and mt5_type:
            if (direction == "BUY" and mt5_type != "BUY") or (
                direction == "SELL" and mt5_type != "SELL"
            ):
                mismatches.append(
                    (
                        ticket,
                        f"Direction mismatch: API {direction} vs MT5 {mt5_type}",
                    )
                )

        entry_diff = abs(data["entry"] - data["price"])
        if entry_diff > 0.1:
            mismatches.append(
                (
                    ticket,
                    f"Entry price diff {entry_diff:.2f} (API {data['entry']} vs MT5 {data['price']})",
                )
            )

    return strategy_stats, mismatches


def main():
    trades = parse_powershell_trades(POWERSHELL_TRADES_RAW)
    positions = parse_mt5_positions(MT5_POSITIONS_RAW)

    matched, only_trades, only_positions = reconcile(trades, positions)
    strategy_stats, mismatches = summarise_matches(matched)

    print("=== Reconciliation Summary ===")
    print(f"Total API trades: {len(trades)}")
    print(f"Total MT5 positions: {len(positions)}")
    print(f"Matched tickets: {len(matched)}")
    print(f"API-only tickets: {len(only_trades)}")
    print(f"MT5-only tickets: {len(only_positions)}")
    print()

    print("Strategy Profit from Matched Trades:")
    for strategy, stats in sorted(strategy_stats.items()):
        print(
            f" - {strategy}: {stats['count']} trades | Profit {stats['profit']:.2f}"
        )
    print()

    if mismatches:
        print("Potential Mismatches:")
        for ticket, detail in mismatches:
            print(f" - Ticket {ticket}: {detail}")
        print()

    if only_trades:
        print("Tickets present in API but missing in MT5 report:")
        for ticket, trade in only_trades.items():
            print(
                f" - {ticket}: {trade['timestamp']} {trade['strategy']} {trade['direction']} entry {trade['entry']} status {trade['status']}"
            )
        print()

    if only_positions:
        print("Tickets present in MT5 report but missing in API history:")
        for ticket, pos in only_positions.items():
            print(
                f" - {ticket}: {pos['open_time']} {pos['type']} {pos['price']} profit {pos['profit']}"
            )
        print()

    print("Done.")


if __name__ == "__main__":
    main()

